# 快速使用指南

## 1. 安装依赖

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install pandas akshare numpy jinja2 plotly openpyxl
```

## 2. 准备数据

确保 `data/指数列表.xlsx` 文件存在，格式如下：

| 指数代码 | 指数名称 | ... |
|---------|---------|-----|
| 000300  | 沪深300  | ... |
| 000510  | 中证A500 | ... |
| 000802  | 500等权  | ... |

## 3. 运行脚本

### 方法 1：运行原始版本 (index_analyzer.py)

```bash
python index_analyzer.py
```

### 方法 2：运行改进版本 (index_analyzer_v2.py) - 推荐

```bash
python index_analyzer_v2.py
```

改进版本的特性：
- 更好的错误处理
- 更美观的 HTML 样式
- 更详细的输出信息
- 更稳定的数据获取

## 4. 查看结果

脚本运行后，在 `output/` 目录中会生成两类文件：

1. **指数报告**: `{指数代码}_{指数名称}_report.html`
   - 包含指数基本信息
   - 十大权重股
   - 近三年走势数据
   - 百分位温度显示

2. **温度计图表**: `{指数代码}_{指数名称}_temperature.html`
   - 交互式 Plotly 温度计
   - 可视化百分位

## 5. 自定义配置

### 限制处理的指数数量

修改脚本中的 `limit` 参数：

```python
# 只处理前 5 个指数
analyzer.process_all_indices(limit=5)

# 处理所有指数
analyzer.process_all_indices()
```

### 修改输出目录

```python
analyzer = IndexAnalyzer(
    excel_path='data/指数列表.xlsx',
    output_dir='my_output'  # 自定义输出目录
)
```

### 修改 Excel 文件路径

```python
analyzer = IndexAnalyzer(
    excel_path='path/to/your/excel.xlsx',  # 自定义 Excel 路径
    output_dir='output'
)
```

## 6. 常见问题

### Q: 脚本运行很慢怎么办？

A: 可以减少处理的指数数量，或者在代码中删除 `time.sleep(1)` 来加快速度（但不建议，可能会被封禁）。

### Q: 某些指数数据获取失败？

A: 这是正常现象，可能原因：
- 指数已停牌
- 数据源暂无该指数数据
- 网络连接问题

失败的指数会被跳过，不会影响其他指数的处理。

### Q: 百分位是什么意思？

A: 百分位表示当前价格在历史价格中的位置：
- 0%: 历史最低
- 50%: 历史中位数
- 100%: 历史最高

例如：百分位 80% 表示当前价格高于 80% 的历史价格。

### Q: 如何自定义 HTML 样式？

A: 修改 `generate_html_report()` 方法中的 CSS 样式部分。

## 7. 示例输出

运行成功后，你会看到类似的输出：

```
============================================================
指数分析工具
============================================================

开始处理指数数据...
限制处理前 5 个指数进行测试
正在处理指数: 沪深300 (000300)
已生成报告: output\000300_沪深300_report.html
正在处理指数: 中证A500 (000510)
获取指数 000510 成份股失败
已生成报告: output\000510_中证A500_report.html
...
共找到 100 个指数
限制处理前 5 个指数进行测试

处理完成！
成功: 5
失败: 0
报告已保存在 output 目录中

============================================================
处理完成！
============================================================
```

## 8. 下一步

- 在浏览器中打开生成的 HTML 文件查看结果
- 根据需要调整脚本参数
- 扩展脚本功能以满足特定需求

## 9. 技术支持

如有问题，请查看 `INDEX_ANALYZER_README.md` 获取更多详细信息。
